The code is based on InterlinkKnight's Arduino sketch:
https://www.youtube.com/watch?v=u2uJMJWsfsg

ALl thanks goes to InterlinkKnight for sharing it!